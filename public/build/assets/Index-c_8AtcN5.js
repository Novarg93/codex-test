import{l as F,c as v,o as l,w as u,r as L,P as U,d as a,p as V,j as M,x as W,g as o,a as n,b as e,t as i,F as f,q as h,n as C,G as J,e as K,f as G,i as w,B as q}from"./app-BkV54G4n.js";import{d as Q,h as X,P as Y,r as Z,b as ee,a as P,_ as te}from"./DefaultLayout.vue_vue_type_script_setup_true_lang-D8s7rDB9.js";import{_ as A}from"./Input-C3P4ssAb.js";import{_ as se}from"./Pagination.vue_vue_type_script_setup_true_lang-hxbp_oH0.js";import{_ as re}from"./SeoHead.vue_vue_type_script_setup_true_lang-CQLBdbsh.js";import{_ as le,a as oe,b as ae,c as ie,d as D}from"./SelectValue-MTlplgDt.js";import{S as T}from"./star-C6MCPq4p.js";import"./pusher-Ci2UwTJi.js";import"./index-1uIKrSfe.js";import"./chevron-down-CDBw7OOm.js";import"./ohash.D__AXeF1-510i-8FH.js";import"./VisuallyHidden-C1EAMf-Z.js";const[Nt,de]=X("SelectGroup");var ne=F({__name:"SelectGroup",props:{asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},setup(x){const d=x,m=Q(void 0,"reka-select-group");return de({id:m}),(c,k)=>(l(),v(a(Y),U({role:"group"},d,{"aria-labelledby":a(m)}),{default:u(()=>[L(c.$slots,"default")]),_:3},16,["aria-labelledby"]))}}),ue=ne;const me={__name:"SelectGroup",props:{asChild:{type:Boolean,required:!1},as:{type:null,required:!1},class:{type:null,required:!1}},setup(x){const d=x,m=Z(d,"class");return(c,k)=>(l(),v(a(ue),U({class:a(ee)("p-1 w-full",d.class)},a(m)),{default:u(()=>[L(c.$slots,"default")]),_:3},16,["class"]))}},ce={class:"w-[90%] 2xl:w-[75%] mx-auto py-8"},_e={class:"border border-border rounded-xl p-4 mb-6"},ge={class:"flex items-center gap-2 mt-1"},pe={class:"text-3xl font-semibold"},fe={class:"flex items-center gap-0.5"},he={class:"text-xs text-muted-foreground mt-1"},ve={class:"flex items-start gap-4 md:items-stretch"},xe={class:"w-full md:w-[420px] space-y-2 mt-4 self-stretch"},be={class:"w-14 text-xs text-muted-foreground"},ye={class:"flex-1 h-2 rounded-full bg-muted overflow-hidden"},we={class:"w-12 text-right text-xs text-muted-foreground"},ke={key:0},Se={key:1},Ne={key:2},$e={class:"grid w-full md:grid-cols-2 gap-4 h-full self-stretch"},Ve={class:"border border-border rounded-xl p-3 h-full flex flex-col"},Me={key:0,class:"mt-3 flex items-center gap-3"},Ce=["src","alt"],Ge={key:1,class:"w-12 h-12 rounded-lg bg-muted border border-border"},Te={class:"min-w-0"},je={class:"font-medium truncate"},Be={class:"text-xs text-muted-foreground"},qe={key:1,class:"mt-2 text-sm text-muted-foreground"},Pe={class:"border border-border rounded-xl p-3 h-full flex flex-col"},Ae={key:0,class:"mt-3 flex items-center gap-3"},De=["src","alt"],Fe={key:1,class:"w-12 h-12 rounded-lg bg-muted border border-border"},Le={class:"min-w-0"},Ue={class:"font-medium truncate"},Ie={class:"flex items-center gap-2 text-xs text-muted-foreground mt-1"},ze={class:"flex items-center gap-0.5"},Re={key:1,class:"mt-2 text-sm text-muted-foreground"},Ee={class:"mt-auto pt-3 text-[11px] text-muted-foreground/70"},He={class:"border border-border rounded-xl p-4 mb-6"},Oe={class:"flex items-center gap-2"},We=["src","alt"],Je={class:"truncate"},Ke={class:"md:col-span-3 flex gap-2 pt-2"},Qe={class:"grid grid-cols-2 gap-4"},Xe={class:"flex items-start justify-between gap-4"},Ye={class:"flex items-start gap-3"},Ze=["src","alt"],et={key:1,class:"w-10 h-10 rounded-full bg-muted"},tt={class:"font-semibold"},st={class:"flex items-center gap-2 text-xs text-muted-foreground"},rt={class:"flex items-center gap-0.5"},lt={key:0},ot={key:0,class:"text-xs whitespace-nowrap rounded-full border border-border bg-muted px-2 py-1 text-muted-foreground"},at={class:"mt-3 whitespace-pre-line"},it={class:"mt-4 pt-3 border-t border-border flex items-center gap-3 text-sm text-muted-foreground"},dt={class:"flex items-center gap-2"},nt=["src","alt"],ut={class:"flex items-center gap-2"},mt=["src","alt"],ct={class:"mt-6 text-sm text-muted-foreground"},$t=F({__name:"Index",props:{filters:{},games:{},reviews:{},stats:{},highlights:{},seo:{}},setup(x){const d=x,m=V(d.filters.rating?.toString()??""),c=V(d.filters.product??""),k=M(()=>Number(d.stats?.total??0)),j=M(()=>Number(d.stats?.avg??0));function b(r){const s=Number(d.stats?.dist?.[r]??0),t=k.value||1;return Math.round(s/t*100)}function S(r){const s=Math.max(0,Math.min(5,Math.round(Number(r)||0)));return Array.from({length:5},(t,g)=>g<s)}const _=V("__all__");W(()=>d.filters.game,r=>{if(!r){_.value="__all__";return}const s=d.games.find(t=>t.name===r);_.value=s?String(s.id):"__all__"},{immediate:!0});const I=M(()=>{if(!_.value||_.value==="__all__")return null;const r=Number(_.value);return d.games.find(t=>t.id===r)?.name??null});function z(){q.get(route("reviews.public"),{rating:m.value?Number(m.value):null,game:I.value,product:c.value.trim()||null},{preserveScroll:!0,preserveState:!0})}function R(){m.value="",c.value="",_.value="__all__",q.get(route("reviews.public"),{preserveScroll:!0,preserveState:!0})}function E(r){if(!r)return"";const s=r.replace(" ","T"),t=new Date(s);return Number.isNaN(t.getTime())?r:new Intl.DateTimeFormat("en-GB",{day:"2-digit",month:"short",year:"numeric"}).format(t)}function H(r){if(!r)return"";const s=r.replace(" ","T"),t=new Date(s);if(Number.isNaN(t.getTime()))return"";let y=new Date().getTime()-t.getTime();y<0&&(y=0);const O=1440*60*1e3,p=Math.floor(y/O);if(p<=0)return"Today";if(p===1)return"1 day ago";if(p<7)return`${p} days ago`;const N=Math.floor(p/7);if(N===1)return"1 week ago";if(N<5)return`${N} weeks ago`;const $=Math.floor(p/30);if($<=11)return $===1?"1 month ago":`${$} months ago`;const B=Math.floor(p/365);return B<=1?"1+ years ago":`${B}+ years ago`}return(r,s)=>(l(),o(f,null,[n(re,{seo:d.seo},null,8,["seo"]),n(te,null,{default:u(()=>[e("section",ce,[s[15]||(s[15]=e("div",{class:"flex items-end justify-between gap-4 mb-6"},[e("div",null,[e("h1",{class:"text-3xl font-semibold"},"Reviews"),e("div",{class:"text-sm text-muted-foreground mt-1"},"Verified & moderated reviews.")])],-1)),e("div",_e,[e("div",null,[s[3]||(s[3]=e("div",{class:"text-xs text-muted-foreground"},"Average rating",-1)),e("div",ge,[e("div",pe,i(j.value.toFixed(1)),1),e("div",fe,[(l(!0),o(f,null,h(S(j.value),(t,g)=>(l(),v(a(T),{key:g,class:C(["h-4 w-4",t?"text-primary fill-primary":"text-muted-foreground/40"])},null,8,["class"]))),128))])]),e("div",he,i(k.value.toLocaleString("en-US"))+" total reviews ",1)]),e("div",ve,[e("div",xe,[(l(),o(f,null,h([5,4,3,2,1],t=>e("div",{key:t,class:"flex items-center gap-3"},[e("div",be,i(t)+"-star",1),e("div",ye,[e("div",{class:"h-full bg-primary",style:J({width:`${b(t)}%`,minWidth:b(t)>0?"10px":"0px"})},null,4)]),e("div",we,[b(t)===0?(l(),o("span",ke,"0%")):b(t)<1?(l(),o("span",Se,"<1%")):(l(),o("span",Ne,i(b(t))+"%",1))])])),64))]),e("div",$e,[e("div",Ve,[s[4]||(s[4]=e("div",{class:"text-sm font-semibold"},"Most reviewed product",-1)),r.highlights.most_reviewed?(l(),o("div",Me,[r.highlights.most_reviewed.image_url?(l(),o("img",{key:0,src:r.highlights.most_reviewed.image_url,class:"w-12 h-12 rounded-lg object-cover border border-border",alt:r.highlights.most_reviewed.name??""},null,8,Ce)):(l(),o("div",Ge)),e("div",Te,[e("div",je,i(r.highlights.most_reviewed.name??"—"),1),e("div",Be,i(r.highlights.most_reviewed.count)+" reviews ",1)])])):(l(),o("div",qe," Not enough data yet. ")),s[5]||(s[5]=e("div",{class:"mt-auto pt-3 text-[11px] text-muted-foreground/70"}," Based on approved reviews. ",-1))]),e("div",Pe,[s[7]||(s[7]=e("div",{class:"text-sm font-semibold"},"Highest score product",-1)),r.highlights.highest_rated?(l(),o("div",Ae,[r.highlights.highest_rated.image_url?(l(),o("img",{key:0,src:r.highlights.highest_rated.image_url,class:"w-12 h-12 rounded-lg object-cover border border-border",alt:r.highlights.highest_rated.name??""},null,8,De)):(l(),o("div",Fe)),e("div",Le,[e("div",Ue,i(r.highlights.highest_rated.name??"—"),1),e("div",Ie,[e("div",ze,[(l(!0),o(f,null,h(S(r.highlights.highest_rated.avg),(t,g)=>(l(),v(a(T),{key:g,class:C(["h-4 w-4",t?"text-primary fill-primary":"text-muted-foreground/40"])},null,8,["class"]))),128))]),e("span",null,i(Number(r.highlights.highest_rated.avg).toFixed(1)),1),s[6]||(s[6]=e("span",null,"·",-1)),e("span",null,i(r.highlights.highest_rated.count)+" reviews",1)])])])):(l(),o("div",Re," Need at least "+i(r.highlights.highest_rated?.min_reviews??5)+" reviews for a product. ",1)),e("div",Ee," Minimum "+i(r.highlights.highest_rated?.min_reviews??5)+" reviews required. ",1)])])])]),e("div",He,[e("form",{onSubmit:K(z,["prevent"]),class:"grid md:grid-cols-3 gap-3"},[e("div",null,[s[8]||(s[8]=e("div",{class:"text-xs text-muted-foreground mb-1"},"Rating (1–5)",-1)),n(a(A),{type:"number",min:"1",max:"5",modelValue:m.value,"onUpdate:modelValue":s[0]||(s[0]=t=>m.value=t),placeholder:"e.g. 5"},null,8,["modelValue"])]),e("div",null,[s[10]||(s[10]=e("div",{class:"text-xs text-muted-foreground mb-1"},"Game",-1)),n(a(le),{modelValue:_.value,"onUpdate:modelValue":s[1]||(s[1]=t=>_.value=t)},{default:u(()=>[n(a(oe),{class:"w-full"},{default:u(()=>[n(a(ae),{placeholder:"Select a game…"})]),_:1}),n(a(ie),{class:"max-h-[320px]"},{default:u(()=>[n(a(me),null,{default:u(()=>[n(a(D),{value:"__all__"},{default:u(()=>[...s[9]||(s[9]=[G("All games",-1)])]),_:1}),(l(!0),o(f,null,h(r.games,t=>(l(),v(a(D),{key:t.id,value:String(t.id)},{default:u(()=>[e("div",Oe,[t.image_url?(l(),o("img",{key:0,src:t.image_url,class:"w-5 h-5 rounded object-cover",alt:t.name},null,8,We)):w("",!0),e("span",Je,i(t.name),1)])]),_:2},1032,["value"]))),128))]),_:1})]),_:1})]),_:1},8,["modelValue"]),s[11]||(s[11]=e("div",{class:"text-[11px] text-muted-foreground mt-1"},"Pick from existing games.",-1))]),e("div",null,[s[12]||(s[12]=e("div",{class:"text-xs text-muted-foreground mb-1"},"Product",-1)),n(a(A),{modelValue:c.value,"onUpdate:modelValue":s[2]||(s[2]=t=>c.value=t),placeholder:"Type product name…"},null,8,["modelValue"])]),e("div",Ke,[n(a(P),{type:"submit"},{default:u(()=>[...s[13]||(s[13]=[G("Apply filters",-1)])]),_:1}),n(a(P),{type:"button",variant:"secondary",onClick:R},{default:u(()=>[...s[14]||(s[14]=[G("Cancel",-1)])]),_:1})])],32)]),e("div",Qe,[(l(!0),o(f,null,h(r.reviews.data,t=>(l(),o("div",{key:t.id,class:"border border-border rounded-xl p-4"},[e("div",Xe,[e("div",Ye,[t.avatar_url?(l(),o("img",{key:0,src:t.avatar_url,class:"w-10 h-10 rounded-full object-cover",alt:t.display_name??"User"},null,8,Ze)):(l(),o("div",et)),e("div",null,[e("div",tt,i(t.display_name??"Verified customer"),1),e("div",st,[e("div",rt,[(l(!0),o(f,null,h(S(t.rating),(g,y)=>(l(),v(a(T),{key:y,class:C(["h-4 w-4",g?"text-primary fill-primary":"text-muted-foreground/40"])},null,8,["class"]))),128))]),t.published_at?(l(),o("span",lt,"· "+i(E(t.published_at)),1)):w("",!0)])])]),t.published_at?(l(),o("div",ot,i(H(t.published_at)),1)):w("",!0)]),e("div",at,i(t.body),1),e("div",it,[e("div",dt,[t.game?.image_url?(l(),o("img",{key:0,src:t.game.image_url,class:"w-6 h-6 rounded object-cover",alt:t.game?.name??""},null,8,nt)):w("",!0),e("span",null,i(t.game?.name??"—"),1)]),e("div",ut,[t.product?.image_url?(l(),o("img",{key:0,src:t.product.image_url,class:"w-6 h-6 rounded object-cover",alt:t.product?.name??""},null,8,mt)):w("",!0),e("span",null,i(t.product?.name??"—"),1)])])]))),128))]),e("div",ct,[n(se,{links:r.reviews.links},null,8,["links"])])])]),_:1})],64))}});export{$t as default};
